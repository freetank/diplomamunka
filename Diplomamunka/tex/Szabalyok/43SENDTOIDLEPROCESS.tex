\begin{greyBox}

\begin{kblock}

\krule{
    \newline
    \kmiddle{\PROCESS_COLOR}{process}{
      \parbox {1000pt}{
      \kprefix{\K_COLOR}{k}{
        \reduce
          {\terminal{\$wait\_msg} \; \kra \; \terminal{receive} \variable[Match]{M}{user} \terminal{end}}
          {\terminal{receive} \variable[Match]{M}{user} \terminal{end}}
      }
      \kall{\PID_COLOR}{pid}{
        \variable[]{P}{}
      }
      \ksuffix{\MAILBOX_COLOR}{mailbox}{
        \reduce
          {\dotCt{List}}
          {\terminal{ListItem}(\variable[]{V}{})}
      }
      }
    }
    \newline
    \kmiddle{\PROCESS_COLOR}{process}{
      \kprefix{\K_COLOR}{k}{
        \reduce
          {\variable[Pid]{P}{user} \mathrel{!} \variable[Value]{V}{user}}
          {\variable[]{V}{}}
      }
    }
    \kall{\PROCESSIDS_COLOR}{processIds}{
      \variable[]{Ids}{}
    }
    \newline
    \kall{\IDLEPROCESSES_COLOR}{idleProcesses}{
      \reduce
        {\variable[]{Idles}{}}
        {\variable[]{Idles}{} [\variable[]{P}{} \leftarrow \; \terminal{undef}]}
    }
    \kall{\PROCESSESCHECKMAILS_COLOR}{processesCheckMails}{
      \reduce      
        {\dotCt{Set}}
        {\terminal{SetItem}(\variable[]{P}{})}
    }
    \newline
    \kall{\TIME_COLOR}{time}{
      \reduce
        {\variable[]{T}{}}
        {\builtinIntPlus{\variable[]{T}{}}{10}}
    }
  }
  {\variable[]{P}{} \terminal{in} \variable[]{Ids}{}}
  {}{}{}
\end{kblock}

\end{greyBox}